

  
    
  


  




  


  

<!DOCTYPE html>
<html lang="es-es">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.56.3 with theme Tranquilpeak 0.4.3-BETA">
    <title>C√≥mo calcular el √çndice de Precipitaci√≥n Estandarizado en R</title>
    <meta name="author" content="Elio Campitelli">
    <meta name="keywords" content=", R">

    <link rel="icon" href="../../../favicon.png">
    

    
    <meta name="description" content="El √çndice de Precipitaci√≥n Estandarizado (SPI por Standarized Precipitation Index) es un √≠ndice para evaluar el estado de sequ√≠a o exceso de lluvia. La idea del SPI es tener una idea de qu√© tan probable es tener una cantidad de lluvia igual o menor. Valores altos del SPI est√°n asociados con √©pocas muy h√∫medas mientras que valores bajos indican sequ√≠a.
En la pr√°ctica lo que se hace es la funci√≥n de probabilidad acumulada a partir de los registros hist√≥ricos y luego estimar la probabilidad para la cantidad observada en cada mes.">
    <meta property="og:description" content="El √çndice de Precipitaci√≥n Estandarizado (SPI por Standarized Precipitation Index) es un √≠ndice para evaluar el estado de sequ√≠a o exceso de lluvia. La idea del SPI es tener una idea de qu√© tan probable es tener una cantidad de lluvia igual o menor. Valores altos del SPI est√°n asociados con √©pocas muy h√∫medas mientras que valores bajos indican sequ√≠a.
En la pr√°ctica lo que se hace es la funci√≥n de probabilidad acumulada a partir de los registros hist√≥ricos y luego estimar la probabilidad para la cantidad observada en cada mes.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="C√≥mo calcular el √çndice de Precipitaci√≥n Estandarizado en R">
    <meta property="og:url" content="/2017/12/calcular-ipe-r/">
    <meta property="og:site_name" content="C√≥digo R">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="C√≥digo R">
    <meta name="twitter:description" content="El √çndice de Precipitaci√≥n Estandarizado (SPI por Standarized Precipitation Index) es un √≠ndice para evaluar el estado de sequ√≠a o exceso de lluvia. La idea del SPI es tener una idea de qu√© tan probable es tener una cantidad de lluvia igual o menor. Valores altos del SPI est√°n asociados con √©pocas muy h√∫medas mientras que valores bajos indican sequ√≠a.
En la pr√°ctica lo que se hace es la funci√≥n de probabilidad acumulada a partir de los registros hist√≥ricos y luego estimar la probabilidad para la cantidad observada en cada mes.">
    
      <meta name="twitter:creator" content="@d_olivaw">
    
    

    
    

    
      <meta property="og:image" content="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=640">
    

    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="../../../css/style-jsjn0006wyhpyzivf6yceb31gvpjatbcs3qzjvlumobfnugccvobqwxnnaj8.min.css" />
    
    
      
        <link rel="stylesheet"  href="../../../css/custom.css">
      
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="2">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="../../../">C√≥digo R</a>
  </div>
  
    
      <a class="header-right-picture "
         href="../../../#about">
    
    
    
      
        <img class="header-picture" src="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=90" alt="Foto de autor" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="2">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="../../../#about">
          <img class="sidebar-profile-picture" src="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=110" alt="Foto de autor" />
        </a>
        <h4 class="sidebar-profile-name">Elio Campitelli</h4>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Inicio</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categor√≠as</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archivos</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">Acerca de</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/eliocamp">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.r-bloggers.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">R-Bloggers</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="http://twitter.com/d_olivaw">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="2"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      C√≥mo calcular el √çndice de Precipitaci√≥n Estandarizado en R
    </h1>
  
  


  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2017-12-21T00:00:00Z">
        
  Diciembre 21, 2017

      </time>
    
    
  
  
    <span>en</span>
    
      <a class="category-link" href="../../../categories/r">R</a>
    
  

  </div>

</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    });
    </script>
    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              


<p>El √çndice de Precipitaci√≥n Estandarizado (SPI por Standarized Precipitation Index) es un √≠ndice para evaluar el estado de sequ√≠a o exceso de lluvia. La idea del SPI es tener una idea de qu√© tan probable es tener una cantidad de lluvia igual o menor. Valores altos del SPI est√°n asociados con √©pocas muy h√∫medas mientras que valores bajos indican sequ√≠a.</p>
<p>En la pr√°ctica lo que se hace es la funci√≥n de probabilidad acumulada a partir de los registros hist√≥ricos y luego estimar la probabilidad para la cantidad observada en cada mes. Luego, esa probabildiad se convierte a su cuantil apropiado seg√∫n una distribuci√≥n normal est√°ndar. De manera que, al final, el SPI indica cu√°ntos desv√≠os est√°ndar lejos de la media es la precipitaci√≥n en cada mes.</p>
<p>En otras palabras, a grandes razgos:</p>
<pre class="r"><code>spi &lt;- qnorm(ecdf(precipitacion)(precipitacion))</code></pre>
<p>Algunos detalles extra:</p>
<ul>
<li><p>antes se suele aplica un promedio m√≥vil para capturar las variaciones de precipitaci√≥n en determinadas escalas temporales.</p></li>
<li><p>el SPI calculado de esta manera da casos con precipitaci√≥n tan extrema que R tira <span class="math inline">\(\pm \infty\)</span>. Entonces hay que rellenar esos datos de manera que el desv√≠o et√°ndar de toda la serie siga siendo 1 y luego restar la media para que quede centrado en 0.</p></li>
</ul>
<p>En R existe un paquete llamado <code>spi</code>, pero analizando el c√≥digo fuente de <code>spi::spi</code>, me parece que tiene algunos bugs importantes que hacen que su resultado no sea fiable. Aparentemente una traducci√≥n de un c√≥digo de FORTRAN o alg√∫n otro lenguaje de bajo nivel, en un bloque <code>if</code> en el que deber√≠a transponer la matriz de datos, en realidad resulta una matriz con s√≥lo 3 columnas.</p>
<pre class="r"><code>for (i in 2:ncolumn) {
   if (i == 2) {
      data_aux1 = rbind(t(data[i - 1, ]), t(data[i, ]))
   }
   else {
      data_aux = rbind(data_aux1, t(data[i, ]))    # ac√° est√° el problema
   }
}</code></pre>
<p>Siguiendo lo que hace el <code>for</code>, se ve que al final el <code>data_aux</code> es una matriz transpuesta pero s√≥lo de las columnas de <code>data</code> 1, 2 y <code>ncolum</code>. La matriz <code>data_aux</code> es la que luego se usa para estimar la funci√≥n de probabilidad acumulada; en vez de hacerse sobre toda la serie, se hace sobre 3 a√±os.</p>
<p>Adem√°s, el SPI debe estimarse <strong>para cada mes por separado</strong> de manera de filtrar cualquier ciclo estacional. Pero <code>spi::spi</code> hace el c√°lculo sobre todo junto. Esto explica por qu√© en el gr√°fico de ejemplo se ve un claro ciclo estacional que no deber√≠a estar ah√≠.</p>
<pre class="r"><code>library(spi)
data(spi_data)
write.table(spi_data,file=&quot;spi.txt&quot;,quote=FALSE,row.names=TRUE)
spi::spi(7,&quot;spi.txt&quot;,1963,2010,&quot;Standardized Precipitation Index - Rio Grande do Norte State&quot;,1,&quot;years&quot;,&quot;months&quot;)</code></pre>
<p><img src="../../../post/2017-12-21-como-calcular-spi-r_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Existe otro paquete, <a href="https://cran.r-project.org/web/packages/precintcon/index.html"><code>precintcon</code></a>, que no parece tener esos problemas y adem√°s en vez de estimar la distribuci√≥n de probabilidad acumulada, le ajusta una distribuci√≥n Gamma, que es bastante usada para modelar precipitaci√≥n. El problema, para m√≠, es que las funciones relacionadas con PSI s√≥lo se pueden aplicar sobre data.frames enteros y con clases especiales. Yo prefiero trabajar con clases primitivas que s√© lo que hacen y qu√© son y que brinden m√°s libertad al usuario. En particular, prefiero datos que est√©n en formato <em>tidy</em>.</p>
<p>Pero entonces hay que armarse la funci√≥n propia:</p>
<pre class="r"><code># Media movil
rollmean &lt;- function(x, k = 3, na.rm = TRUE) {
   lapply(k, function(e) .rollmean(x, e, na.rm = na.rm))
}

.rollmean &lt;- function(x, k, na.rm ) {
   i &lt;- seq_along(x)
   j &lt;- i - k + 1
   j &lt;- ifelse(j &lt;= 0, 1, j)
   pp &lt;- sapply(i, function (e)  mean(x[j[e]:e], na.rm = na.rm))
}

# SPI
spi &lt;- function(pp) {
   norm &lt;- qnorm(ecdf(pp)(pp))
   
   # de http://www.cmc.org.ve/mediawiki/index.php?title=Herramienta_en_R_para_diagn%C3%B3stico
   norm.fin &lt;- norm[norm != Inf &amp; norm != -Inf]
   minimize &lt;- function(x) (1 - sd(c(x, norm.fin)))^2
   norm[norm == Inf] &lt;- optimize(minimize, lower=0, upper=100)$minimum
   return(norm - mean(norm))
}</code></pre>
<p>La raz√≥n por la cual hay 2 funciones de media m√≥vil es que la primera est√° vectorizada en <code>k</code>, lo que significa que se puede hacer <code>roll &lt;- rollmean(x, 1:3)</code> para obtener una lista con 3 medias m√≥viles con distinto <code>k</code>.</p>
<p>Y listo. Para probar la funci√≥n con los datos de <code>spi</code>, primero hay que tenerlos en un formato razonable.</p>
<pre class="r"><code>library(data.table)
pp &lt;- setDT(melt(spi_data, id.vars = &quot;Months&quot;, variable.name = &quot;year&quot;, value.name = &quot;pp&quot;))
pp[, year := as.numeric(substr(year, 2, 5))]
pp[, month.n := 1:7, by = year]
pp[, date := lubridate::ymd(paste0(year, &quot;-&quot;, month.n, &quot;-15&quot;))]

pp &lt;- pp[, .(date, pp)]
knitr::kable(head(pp))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">date</th>
<th align="right">pp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1963-01-15</td>
<td align="right">74.1</td>
</tr>
<tr class="even">
<td align="left">1963-02-15</td>
<td align="right">155.2</td>
</tr>
<tr class="odd">
<td align="left">1963-03-15</td>
<td align="right">226.4</td>
</tr>
<tr class="even">
<td align="left">1963-04-15</td>
<td align="right">186.7</td>
</tr>
<tr class="odd">
<td align="left">1963-05-15</td>
<td align="right">37.2</td>
</tr>
<tr class="even">
<td align="left">1963-06-15</td>
<td align="right">23.6</td>
</tr>
</tbody>
</table>
<p>As√≠, con una observaci√≥n de precipitaci√≥n para cada fecha, podemos calcular el SPI en una sola l√≠nea:</p>
<pre class="r"><code>pp[, pp.roll := rollmean(pp, k = 3)]
pp[, SPI := spi(pp.roll), by = month(date)]

meses &lt;- c(&quot;Ene&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Abr&quot;, &quot;May&quot;, &quot;Jun&quot;, 
           &quot;Jul&quot;, &quot;Ago&quot;, &quot;Sep&quot;, &quot;Oct&quot;, &quot;Nov&quot;, &quot;Dic&quot;)
spi.breaks &lt;- c(-2.4, -2, -1.6, -1.3, -0.8, -0.5, 0.5, 0.8, 1.3, 1.6, 2, 2.4)
library(ggplot2)
ggplot(pp, aes(month(date), year(date))) +
   geom_contour(aes(z = SPI, color = ..level..), breaks = spi.breaks) +
   scale_color_distiller(name = &quot;SPI&quot;, 
                         palette = &quot;BrBG&quot;, direction = 1) +
   scale_x_continuous(name = &quot;Mes&quot;, expand = c(0, 0), 
                      breaks = 1:7, 
                      labels = meses[1:7]) +
   scale_y_continuous(name = &quot;A√±o&quot;, expand = c(0, 0), trans = &quot;reverse&quot;) +
   theme_minimal()</code></pre>
<p><img src="../../../post/2017-12-21-como-calcular-spi-r_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Cabe aclarar que como los datos no cubren todo el a√±o, en realidad el promedio movil no tiene sentido. Para probarlo voy a primero crear una serie de datos sint√©tica con un ciclo anual.</p>
<pre class="r"><code>pp2 &lt;- data.table(date = seq.Date(as.Date(&quot;1985-01-01&quot;), as.Date(&quot;2015-12-01&quot;), 
                                  by = &quot;1 month&quot;))
set.seed(42)    # ¬°reproducible!
pp2[, pp := rgamma(.N, shape = 1, scale = 10*(cos((month(date) - 1)/11*pi*2) + 1))]</code></pre>
<p>Y ahora s√≠, calcular el SPI como se debe y para todas las escalas de tiempo que queramos.</p>
<pre class="r"><code>pp2[, as.character(1:12) := rollmean(pp, 1:12)]
pp.long &lt;- melt(pp2[, -&quot;pp&quot;], id.vars = &quot;date&quot;, variable.name = &quot;k&quot;, value.name = &quot;pp&quot;)
pp.long[, k := as.numeric(as.character(k))]
pp.long[, SPI := spi(pp), by = .(month(date), k)]

ggplot(pp.long, aes(date, k)) +
   geom_tile(aes(fill = SPI, color = SPI)) +
   scale_fill_distiller(name = &quot;SPI&quot;, 
                         palette = &quot;BrBG&quot;, direction = 1) +
      scale_color_distiller(name = &quot;SPI&quot;, 
                         palette = &quot;BrBG&quot;, direction = 1) +
   scale_x_date(name = &quot;Fecha&quot;, expand = c(0, 0)) +
   scale_y_continuous(name = &quot;Escala temporal&quot;, expand = c(0, 0), 
                      breaks = 1:12) +
   theme_minimal()</code></pre>
<p><img src="../../../post/2017-12-21-como-calcular-spi-r_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2018/01/buen-ejemplo-reproducible-en-r/" data-tooltip="C√≥mo hacer un buen ejemplo reproducible en R">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">SIGUIENTE</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <span class="hide-xs hide-sm text-small icon-mr">ANTERIOR</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2017/12/calcular-ipe-r/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2017/12/calcular-ipe-r/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2017/12/calcular-ipe-r/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2021 Elio Campitelli. Todos los derechos reservados
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2018/01/buen-ejemplo-reproducible-en-r/" data-tooltip="C√≥mo hacer un buen ejemplo reproducible en R">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">SIGUIENTE</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <span class="hide-xs hide-sm text-small icon-mr">ANTERIOR</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2017/12/calcular-ipe-r/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2017/12/calcular-ipe-r/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2017/12/calcular-ipe-r/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="2">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2F2017%2F12%2Fcalcular-ipe-r%2F">
          <i class="fa fa-facebook-official"></i><span>Compartir en Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2F2017%2F12%2Fcalcular-ipe-r%2F">
          <i class="fa fa-twitter"></i><span>Compartir en Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%2F2017%2F12%2Fcalcular-ipe-r%2F">
          <i class="fa fa-google-plus"></i><span>Compartir en Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=110" alt="Foto de autor" />
    
    <h4 id="about-card-name">Elio Campitelli</h4>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Atmospheric sciences graduate researcher at CONICET
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Argentina
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Buscar" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no se encontraron art√≠culos</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2021/03/star-trek-rakings/">
                <h3 class="media-heading">Analizando ratings de Star Trek en IMDB</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Mar 3, 2021
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Con mi novia estamos viendo Star Trek: The New Generation. La primera temporada es bastante mala, pero luego remonta. Me dio curiosidad si los ratings mostraban eso. Entonces empec√© a bajar los ratings de cada cap√≠tulo en IMDB. En el medio, me encontr√© que IMDB provee ratings promedio por demograf√≠a, as√≠ que decid√≠ tambi√©n bajar eso.
Y ya que estamos, baj√© tambi√©n los ratings de las otras series de Star Trek.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2019/12/rammbot-un-bot-que-crea-canciones-de-rammstein/">
                <h3 class="media-heading">Obligu√© a un bot a escuchar m√°s de 1000 horas de Rammstein y le ped√≠ que escribiera una canci√≥n propia.</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Cuando le cont√© a una amiga que hab√≠a analizado las letras de Rammstein y Lacrimosa, me tir√≥ la idea de usar un modelo para crear letras de las bandas. Me pareci√≥ una idea divertida, as√≠ que ac√° tienen el futuro de la m√∫sica:
library(data.table) library(magrittr) Igual que hice antes, bajo las letras de losdiscos de estudio de cada artista. Guardo las cosas en un archivo para no tener que bajar los datos cada vez que corro esto.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2019/11/rammstein-vs-lacrimosa/">
                <h3 class="media-heading">Rammstein vs. Lacrimosa</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Hace un tiempo una conocida twite√≥ que hab√≠a tenido que comprarse un libro entero para aprender los g√©neros gramaticales del alem√°n. Entre las repuestas, hab√≠a una persona que contaba que de adolescente crey√≥ (err√≥neamente) que podr√≠a aprender alem√°n s√≥lo escuchando Rammstein. Habeindo estudiado unos drei Jahre de alem√°n al mismo tiempo que escuchaba Rammstein y otras bandas en alem√°n, las letras de Rammstein siempre me parecieron extremadamente simples.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2019/10/lo-que-aprend%C3%AD-en-latinr-2019/">
                <h3 class="media-heading">Lo que aprend√≠ en LatinR 2019</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Hace unas semanas volv√≠ de Santiago de Chile luego de ir a Latinr 2019. Igual que el a√±o pasado, fue una experiencia divertida. Estas son algunas de las cosas que me llamaron la atenci√≥n.
Workshops A la ma√±ana del primer d√≠a asist√≠ al workshop de Mine √áetinkaya-Rundel sobre ense√±anza de R. Ejemplific√≥ algunos principios b√°sicos a la hora de dise√±ar clases. La idea de ‚Äúdejales comer el pastel primero‚Äù creo que es la principal ense√±anza.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2019/04/ecmwfr-calentamiento-global/">
                <h3 class="media-heading">Midiendo el calentamiento global con ecmwfr</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Apr 4, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Para mi investigaci√≥n necesitaba bajar datos meteorol√≥gicos grillados del ERA-Interim, que es una base de datos generada por el ECMWF. Bajar los datos en su sitio web es muy inc√≥mido y requiere muchos clicks. Por suerte, me encontr√© con el paquete ecmwfr con el que pude bajar los datos directamente desde R y muy f√°cilmente. Una de las cosas geniales del c√≥digo abierto, es que los usuarios pueden ser colaboradores, as√≠ que suger√≠ algunas cosas y aport√© un poco de c√≥digo.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2019/01/metamerismo-estad%C3%ADstico/">
                <h3 class="media-heading">Metamerismo estad√≠stico</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jan 1, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">El paquete <a href="https://github.com/eliocamp/metamer">metamer</a> implementa en R el algoritmo descripto por Matejka y Fitzmaurice (2017) para generar sets de datos distintos entre s√≠ pero con estad√≠sticos id√©nticos. Adem√°s, propongo el nombre &ldquo;met√°meros&rdquo; para estos grupos de datos en analog√≠a con el concepto proveniente de colorimetr√≠a.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2018/10/leyendo-informacion-incucai/">
                <h3 class="media-heading">Leyendo informaci√≥n del INCUCAI</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">El otro d√≠a el diario Clar√≠n sac√≥ una nota afirmando que el pasado agosto se hab√≠a dado el r√©cord hist√≥rico de transplantes de √≥rganos y se lo adjudicaba a la &ldquo;Ley Justina&rdquo;, que establece que todos somos donantes presuntos a menos que se declare lo contrario en vida. Dado que esta ley se aprob√≥ hace poco m√°s de un mes y todav√≠a no est√° reglamentada, es poco probable que este r√©cord se deba al cambio legal.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2018/09/multiple-color-and-fill-scales-with-ggplot2/">
                <h3 class="media-heading">Multiple color (and fill) scales with ggplot2</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">(Versi√≥n en espa√±ol)
tl;dr: The functionality shown in this post is now on the ggnewscale package! üì¶. You can find the original code in this gist.
A somewhat common annoyance for some ggplot2 users is the lack of support for multiple colour and fill scales. Perusing StackOverflow you can find many questions relating to this issue:

Unfortunately, this deluge of questions is met with a shortage of conclusive answers, most of them being some variation of &ldquo;you can&rsquo;t, but here&rsquo;s how to hack it or visualise the data differently&rdquo;.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2018/09/multiples-escalas-colores-ggplot2/">
                <h3 class="media-heading">M√∫ltiples escalas de colores en ggplot2</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Sep 9, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">tl;dr: Esta funcionalidad est√° ahora en el paquete ggnewscale! üì¶ En este gist est√° la versi√≥n origial del c√≥digo.
Un dolor importante para algunos usuarios de ggplot2 es la imposibilidad de usar m√°s de una escala para cada tipo de par√°metro est√©tico. Una b√∫squeda en StackOverflow da como resultado m√∫ltiples preguntas:

Pero ninguna respuesta tiene una soluci√≥n realmente satisfactoria; la mayor√≠a son del tipo &ldquo;no se puede, pero esta es otra forma de graficar tus datos&rdquo;.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="../../../2018/08/periodic-data-ggplot2-ggperiodic/">
                <h3 class="media-heading">Wrapping around ggplot2 with ggperiodic</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">As an atmospheric scientists, a lot of my research consists on plotting and looking at global fields of atmospheric variables like pressure, temperature and the like. Since our planet is a sphere (well, almost), it is unbound and so longitude is a periodic dimension. That is, to the right of 180¬∞E you go back to 180¬∞W. But ggplot2 and other plotting systems, for the most part, assume linear dimensions.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no se encontraron art√≠culos"
         data-message-one="1 art√≠culo encontrado"
         data-message-other="{n} art√≠culos encontrados">
         19 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('/images/cover2.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js" integrity="sha256-XrZQp+ZMfovqr6Hb2M6okHvSEYaB/+Xbx7toWmOOZUM=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css" integrity="sha256-KacbO6Nou2geGJEUzQeKzKEdp/DENVGJKAd2v37moh0=" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="../../../js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = '\/2017\/12\/calcular-ipe-r\/';
          
            this.page.identifier = '\/2017\/12\/calcular-ipe-r\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'codigo-r';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



    
  </body>
</html>

