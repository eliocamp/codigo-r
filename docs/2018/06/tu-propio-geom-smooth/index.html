

  
    
  


  




  


  

<!DOCTYPE html>
<html lang="es-es">
  <head>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Hugo 0.40.3 with theme Tranquilpeak 0.4.3-BETA">
    <title>Tu propio smooth en geom_smooth()</title>
    <meta name="author" content="Elio Campitelli">
    <meta name="keywords" content=", R">

    <link rel="icon" href="../../../favicon.png">
    

    
    <meta name="description" content="Algo incre칤blemente satisfactorio de ggplot2 es la posibilidad de ajustar curvas a los datos de manera s칰per f치cil con geom_smooth(). Para mi investigaci칩n estaba mirando la relaci칩n entre dos 치ngulos y me di cuenta que la recta ajustada por cuadrados m칤nimos no estaba funcionando para ilustrar la obvia estructura que hab칤a en los datos.
library(ggplot2) df &lt;- readRDS(&quot;data/smooth_example.Rds&quot;) ggplot(df, aes(pc.angle, phase)) &#43; geom_point() &#43; geom_smooth(method = &quot;lm&quot;)  Se me ocurri칩 que un mejor modelo podr칤a ser usando el estimador de Theil-Sen, que es la mediana de todas las pendientes entre dos puntos distintos y est치 implementado en el paquete mblm.">
    <meta property="og:description" content="Algo incre칤blemente satisfactorio de ggplot2 es la posibilidad de ajustar curvas a los datos de manera s칰per f치cil con geom_smooth(). Para mi investigaci칩n estaba mirando la relaci칩n entre dos 치ngulos y me di cuenta que la recta ajustada por cuadrados m칤nimos no estaba funcionando para ilustrar la obvia estructura que hab칤a en los datos.
library(ggplot2) df &lt;- readRDS(&quot;data/smooth_example.Rds&quot;) ggplot(df, aes(pc.angle, phase)) &#43; geom_point() &#43; geom_smooth(method = &quot;lm&quot;)  Se me ocurri칩 que un mejor modelo podr칤a ser usando el estimador de Theil-Sen, que es la mediana de todas las pendientes entre dos puntos distintos y est치 implementado en el paquete mblm.">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="Tu propio smooth en geom_smooth()">
    <meta property="og:url" content="/2018/06/tu-propio-geom-smooth/">
    <meta property="og:site_name" content="C칩digo R">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="C칩digo R">
    <meta name="twitter:description" content="Algo incre칤blemente satisfactorio de ggplot2 es la posibilidad de ajustar curvas a los datos de manera s칰per f치cil con geom_smooth(). Para mi investigaci칩n estaba mirando la relaci칩n entre dos 치ngulos y me di cuenta que la recta ajustada por cuadrados m칤nimos no estaba funcionando para ilustrar la obvia estructura que hab칤a en los datos.
library(ggplot2) df &lt;- readRDS(&quot;data/smooth_example.Rds&quot;) ggplot(df, aes(pc.angle, phase)) &#43; geom_point() &#43; geom_smooth(method = &quot;lm&quot;)  Se me ocurri칩 que un mejor modelo podr칤a ser usando el estimador de Theil-Sen, que es la mediana de todas las pendientes entre dos puntos distintos y est치 implementado en el paquete mblm.">
    
      <meta name="twitter:creator" content="@d_olivaw">
    
    

    
    

    
      <meta property="og:image" content="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=640">
    

    
    
    

    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="../../../css/style-jsjn0006wyhpyzivf6yceb31gvpjatbcs3qzjvlumobfnugccvobqwxnnaj8.min.css" />
    
    
      
        <link rel="stylesheet"  href="https://eliocamp.github.io/codigo-r/css/custom.css">
      
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="2">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="../../../">C칩digo R</a>
  </div>
  
    
      <a class="header-right-picture "
         href="../../../#about">
    
    
    
      
        <img class="header-picture" src="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=90" alt="Foto de autor" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="2">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="../../../#about">
          <img class="sidebar-profile-picture" src="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=110" alt="Foto de autor" />
        </a>
        <h4 class="sidebar-profile-name">Elio Campitelli</h4>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Inicio</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categor칤as</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archivos</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">Acerca de</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/eliocamp" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="../../../index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="2"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Tu propio smooth en geom_smooth()
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2018-06-01T00:00:00Z">
        
  
  
  
  
    1 de Junio 2018
  

      </time>
    
    
  
  
    <span>en</span>
    
      <a class="category-link" href="../../../categories/r">R</a>
    
  

  </div>

</div>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    });
    </script>
    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p>Algo incre칤blemente satisfactorio de ggplot2 es la posibilidad de ajustar curvas a los datos de manera s칰per f치cil con <code>geom_smooth()</code>. Para mi investigaci칩n estaba mirando la relaci칩n entre dos 치ngulos y me di cuenta que la recta ajustada por cuadrados m칤nimos no estaba funcionando para ilustrar la obvia estructura que hab칤a en los datos.</p>

<pre><code class="language-r">library(ggplot2)

df &lt;- readRDS(&quot;data/smooth_example.Rds&quot;)

ggplot(df, aes(pc.angle, phase)) +
   geom_point() +
   geom_smooth(method = &quot;lm&quot;)
</code></pre>

<p><img src="../../../post/2018-06-01-tu-propio-smooth-en-geom-smooth_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>

<p>Se me ocurri칩 que un mejor modelo podr칤a ser usando el estimador de <a href="https://en.wikipedia.org/wiki/Theil%E2%80%93Sen_estimator">Theil-Sen</a>, que es la mediana de todas las pendientes entre dos puntos distintos y est치  implementado en el paquete mblm. El problema es que al usar esa funci칩n como m칠todo, me dio este cr칤ptico mensaje de error:</p>

<pre><code class="language-r">ggplot(df, aes(pc.angle, phase)) +
   geom_point() +
   geom_smooth(method = &quot;mblm::mblm&quot;)
</code></pre>

<pre><code>## Warning: Computation failed in `stat_smooth()`:
## object 'mblm::mblm' of mode 'function' was not found
</code></pre>

<p><img src="../../../post/2018-06-01-tu-propio-smooth-en-geom-smooth_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>

<p>游뱂</p>

<p>Tuve que ponerme a leer el c칩digo de ggplot2 para entender de d칩nde ven칤a el problema, pero gracias a eso aprend칤 m치s sobre c칩mo funciona <code>geom_smooth()</code>.</p>

<p><code>geom_smooth()</code> acepta cualquier m칠todo para hacer el modelo, pero con dos detalles importantes:</p>

<ol>
<li><p>la funci칩n que hace el modelo debe aceptar una f칩rmula como primer argumento y tener argumentos <code>data</code> y <code>weigths</code>.</p></li>

<li><p>el objeto que devuelve la funci칩n debe tener un m칠todo para <code>predictdf()</code>.</p></li>
</ol>

<p>Lo primero es f치cil de entender. Dentro de <code>geom_smooth()</code>, ggplot2 b치sicamente llama algo as칤 como <code>lm(formula, data, weights, ...)</code>. Si la funci칩n no acepta alguno de esos argumentos, nos encontramos con un error. La funci칩n <code>mblm</code> no entiende el argumento <code>weights</code>. La soluci칩n en ese caso fue crear mi propia funci칩n que llame a <code>mblm::mblm()</code> descartando ese argumento (y de paso le puse un nombre m치s inteligible).</p>

<pre><code class="language-r">TheilSen &lt;- function(..., weights = NULL) {
   mblm::mblm(...)
}

ggplot(df, aes(pc.angle, phase)) +
   geom_point() +
   geom_smooth(method = &quot;TheilSen&quot;)
</code></pre>

<p><img src="../../../post/2018-06-01-tu-propio-smooth-en-geom-smooth_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>

<p>춰Mucho mejor! 游돜</p>

<p>El segundo requisito en este ejemplo viene &ldquo;gratis&rdquo; porque <code>mblm()</code> es compatible con los m칠todos de <code>predict()</code> de <code>lm()</code>, pero no siempre es as칤. En este segundo ejemplo, quiero hacer un suavizado que se base en hacer la transformada de fourier y eliminar una determinada cantidad de frecuencias. Una funci칩n que hace eso ser칤a esta:</p>

<pre><code class="language-r"># n es la proporci칩n de frecuencias que vamos a eliminar. 
# n = 0.5 significa sacar la mitad.
FFTSmooth &lt;- function(formula, data, weights, n = 0.5) {
   f &lt;- fft(data$y)
   keep &lt;- c(0, seq_len(floor(length(f)/2*n)))
   keep &lt;- c(keep + 1, length(f) - keep[keep != 0] + 1)
   f[-keep] &lt;- 0 + 0i
   Re(fft(f, inverse = T))/length(f)
}
</code></pre>

<p>Notar que la funci칩n ignora por completo la formula y los pesos, pero hay que ponerlos para que funcione en <code>geom_smooth()</code>. Esta funci칩n sirve en el sentido de que hace un suavizado correcto de los datos (춰siempre que est칠n definidos en intervalos de x regulares!), pero si usamos <code>geom_smooth(method = &quot;FFTSmooth&quot;)</code> ggplot2 nos va a tirar un error:</p>

<blockquote>
<p>Computation failed in <code>stat_smooth()</code>: no applicable method for &lsquo;predict&rsquo; applied to an object of class &ldquo;c(&lsquo;double&rsquo;, &lsquo;numeric&rsquo;)&rdquo;</p>
</blockquote>

<p>El problema es que <code>FTTSmooth()</code> devuelve los valores suavizados, pero lo que tiene que devolver es un &ldquo;modelo&rdquo; que devuelva los valores suavizados al hacer <code>predictdf(model, xseq, se, level)</code> (donde <code>xseq</code> son los puntos de x donde se eval칰a el modelo, <code>se</code> es TRUE o FALSE seg칰n si queremos un intervalo de confianza y <code>level</code> es el nivel de confianza de dicho intervalo). Esta segunda implementaci칩n del suavizado s칤 funciona.</p>

<pre><code class="language-r">FFTSmooth &lt;- function(formula, data, weights, n = 0.5) {
   f &lt;- fft(data$y)
   keep &lt;- c(0, seq_len(floor(length(f)/2*n)))
   keep &lt;- c(keep + 1, length(f) - keep[keep != 0] + 1)
   f[-keep] &lt;- 0 + 0i
   
   model &lt;- list(x = data$x, pred = Re(fft(f, inverse = T))/length(f))
   class(model) &lt;- &quot;my_smooth&quot;
   return(model)
}

predictdf.my_smooth &lt;- function(model, xseq, se, level) {
   data.frame(x = model$x, y = model$pred)
}
</code></pre>

<p>La diferencia importante en <code>FFTSmooth()</code> es que ahora devuelve una lista con los valores de <code>x</code> y los de <code>y</code> suavizados pero que tiene clase &ldquo;my_smooth&rdquo;. Cuando ggplot2 llame <code>predictdf(model, ...)</code>, R va a buscar la funci칩n <code>predictdf.my_smooth()</code> (as칤 es b치sicamente c칩mo funcionan las <a href="http://adv-r.had.co.nz/S3.html">clases</a> en R). <code>predictdf.my_smooth()</code>, por su parte, ignora casi todos los inputs y simplemente devuelve un <code>data.frame</code> con los valores de <code>x</code> e <code>y</code> guardados en el modelo.</p>

<pre><code class="language-r">set.seed(42)
df &lt;- data.frame(x = seq(0, 360, length.out = 100))
df$y &lt;- with(df, 5*cos(x*pi/180) + 3*sin(x*pi/180*3) + 1.6*rnorm(100))

ggplot(df, aes(x, y)) +
   geom_point() +
   geom_smooth(method = &quot;FFTSmooth&quot;, method.args = list(n = 0.2))
</code></pre>

<p><img src="../../../post/2018-06-01-tu-propio-smooth-en-geom-smooth_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>

<p>춰Y listo! 游꼻</p>

<p>S칩lo hace falta definir <code>predictdf.my_smooth()</code> una vez. Por ejemplo, si queremos usar una Spline.</p>

<pre><code class="language-r">SplineSmooth &lt;- function(formula, data, weights, span = 0.5, ...) {
   pred &lt;- smooth.spline(data$x, data$y, df = length(data$y)*span,...)$y
   # print(pred[1:10])
   model &lt;- list(x = data$x, pred = pred)
   class(model) &lt;- &quot;my_smooth&quot;
   model
}

ggplot(df, aes(x, y)) +
   geom_point() +
   geom_smooth(method = &quot;SplineSmooth&quot;, method.args = list(span = 0.1))
</code></pre>

<p><img src="../../../post/2018-06-01-tu-propio-smooth-en-geom-smooth_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>

<p>Un resultado similar puede conseguirse de manera m치s directa con <a href="../../../2018/05/como-hacer-un-stat-generico-en-ggplot2/"><code>stat_rasa()</code></a>, pero me pareci칩 interesante urgar un poco dentro del funcionamiento de ggplot2.</p>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">ETIQUETADO EN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="../../../tags/ggplot2/">ggplot2</a>

                  </div>
                
              
            
            
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">SIGUIENTE</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2018/05/presentacion-powerpoint-rmarkdown/" data-tooltip="Hacer una presentaci칩n de PowerPoint a partir de rmarkdown">
              
                  <span class="hide-xs hide-sm text-small icon-mr">ANTERIOR</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2018 Elio Campitelli. Todos los derechos reservados
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="2">
        
  <div class="post-actions-wrap">
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">SIGUIENTE</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="../../../2018/05/presentacion-powerpoint-rmarkdown/" data-tooltip="Hacer una presentaci칩n de PowerPoint a partir de rmarkdown">
              
                  <span class="hide-xs hide-sm text-small icon-mr">ANTERIOR</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  </div>


      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="2">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Feliocamp.github.io%2Fcodigo-r%2F2018%2F06%2Ftu-propio-geom-smooth%2F">
          <i class="fa fa-facebook-official"></i><span>Compartir en Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Feliocamp.github.io%2Fcodigo-r%2F2018%2F06%2Ftu-propio-geom-smooth%2F">
          <i class="fa fa-twitter"></i><span>Compartir en Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3A%2F%2Feliocamp.github.io%2Fcodigo-r%2F2018%2F06%2Ftu-propio-geom-smooth%2F">
          <i class="fa fa-google-plus"></i><span>Compartir en Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="//www.gravatar.com/avatar/2376976935665241d1fd5a1fb8124a81?s=110" alt="Foto de autor" />
    
    <h4 id="about-card-name">Elio Campitelli</h4>
    
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Argentina
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Buscar" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no se encontraron art칤culos</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/06/tu-propio-geom-smooth/">
                <h3 class="media-heading">Tu propio smooth en geom_smooth()</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Algo incre칤blemente satisfactorio de ggplot2 es la posibilidad de ajustar curvas a los datos de manera s칰per f치cil con geom_smooth(). Para mi investigaci칩n estaba mirando la relaci칩n entre dos 치ngulos y me di cuenta que la recta ajustada por cuadrados m칤nimos no estaba funcionando para ilustrar la obvia estructura que hab칤a en los datos.
library(ggplot2) df &lt;- readRDS(&quot;data/smooth_example.Rds&quot;) ggplot(df, aes(pc.angle, phase)) + geom_point() + geom_smooth(method = &quot;lm&quot;)  Se me ocurri칩 que un mejor modelo podr칤a ser usando el estimador de Theil-Sen, que es la mediana de todas las pendientes entre dos puntos distintos y est치 implementado en el paquete mblm.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/05/presentacion-powerpoint-rmarkdown/">
                <h3 class="media-heading">Hacer una presentaci칩n de PowerPoint a partir de rmarkdown</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">La interfaz entre usuarios de knitr/markdown y word/powerpoint no deja de ser 치spera ya que es dif칤cil cambiar el workflow propio para acomodar el de otras personas. En particular, es muy com칰n tener que colaborar con personas que se sienten mucho m치s c칩modas trabajando con presentaciones en PowerPoint que en las creadas con beamer o ioslides. Una forma de reducir la fricci칩n ser칤a la de generar un ppt autom치ticamente a partir de una archivo de markdown.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/05/arte-reproducible-del-subte-de-buenos-aires/">
                <h3 class="media-heading">Arte reproducible del Subte de Buenos Aires</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">El s치bado pasado est치bamos en el subte con mi novia y pasamos por la estaci칩n 츼ngel Gallardo de la L칤nea B y notamos que ten칤a unas ilustraciones en las paredes hechas a partir de l칤neas de distinto grosor.
Charlamos un poco sobre ese estilo y c칩mo se pod칤a replicar con ggplot2 usando el paquete ggridges.
Lo primero que hago es leer la imagen. Este paso depende del formato (a menos que haya alguna forma de seleccionar el formato correcto autom치ticamente, pero no conozco).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/05/como-hacer-un-stat-generico-en-ggplot2/">
                <h3 class="media-heading">Como hacer un stat gen칠rico en ggplot2</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Hace un tiempo que ven칤a pensando que si bien ggplot2 es genial y tiene un mont칩n de geoms y stats, le faltaba la opci칩n de extenderlo a stats y geoms creados por el usuario. Luego, aprend칤 que ggplot2 tiene un excelente sistema para extenderlo y empec칠 a crear mis propios stats. Pero a칰n as칤, hacer un stat espec칤fico cada vez que uno quiere hacer un plot en particular es demasiado complicado.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/05/how-to-make-a-generic-stat-in-ggplot2/">
                <h3 class="media-heading">How to make a generic stat in ggplot2</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">For a while now I&rsquo;ve been thinking that, yes, ggplot2 is awesome and offers a lot of geoms and stats, but it would be great if it could be extended with new user-generated geoms and stats. Then I learnt that ggplot2 actually has a pretty great extension system so I could create my own geoms I needed for my work or just for fun. But still, creating a geom from scratch is an involved process that doesn&rsquo;t lend itself to simple transformations.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/02/how-to-make-shaded-relief-in-r/">
                <h3 class="media-heading">How to make a shaded relief in R</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Spanish version of this post
While trying to build a circular colour scale to plot angles and wind direction, I stumbled upon an easy way to make shaded reliefs in R. You known, when you look at cool maps of mountain areas where peaks and valleys are easily distinguishable from their shadows like this:
What I accidentally discovered is that one way of approximating this look is by taking the directional derivatives of height and then plotting the cosine of its angle from the sun.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/01/como-hacer-efecto-de-relieve-en-r/">
                <h3 class="media-heading">C칩mo hacer un efecto de relieve en R</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jan 1, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">(Versi칩n en ingl칠s)
Estaba tratando de hacer una gu칤a de colores circular (que los extremos tengan el mismo color) para hacer gr치ficos de 치ngulos o direcciones del viento, cuando descubr칤 una forma interesante de crear un efecto de relieve en mapas de topograf칤a.
Digamos que tenemos datos de altura del suelo sobre el nivel del mar en una grilla regular. Como ejemplo vamos a usar la vieja y querida volcano.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/01/como-hacer-efecto-de-relieve-en-r/">
                <h3 class="media-heading">C칩mo hacer un efecto de relieve en R</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jan 1, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">(Versi칩n en ingl칠s)
Estaba tratando de hacer una gu칤a de colores circular (que los extremos tengan el mismo color) para hacer gr치ficos de 치ngulos o direcciones del viento, cuando descubr칤 una forma interesante de crear un efecto de relieve en mapas de topograf칤a.
Digamos que tenemos datos de altura del suelo sobre el nivel del mar en una grilla regular. Como ejemplo vamos a usar la vieja y querida volcano.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2018/01/buen-ejemplo-reproducible-en-r/">
                <h3 class="media-heading">C칩mo hacer un buen ejemplo reproducible en R</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jan 1, 2018
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Es muy dif칤cil dar ayuda si no se sabe cu치l es el problema. Un buen ejemplo de lo que est치 mal que cualquiera pueda correr en sus computadoras es casi esencial para recibir ayuda.
Un buen ejemplo reproducible (o reprex) es b치sicamente el feliz matrimonio entre un set de datos m칤nimo y un c칩digo m칤nimo que ilustre el problema y que cualquiera pueda copiar, pegar en un script y obtener exactamente los mismos resultados.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="https://eliocamp.github.io/codigo-r/2017/12/calcular-ipe-r/">
                <h3 class="media-heading">C칩mo calcular el 칈ndice de Precipitaci칩n Estandarizado en R</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Dec 12, 2017
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">El 칈ndice de Precipitaci칩n Estandarizado (SPI por Standarized Precipitation Index) es un 칤ndice para evaluar el estado de sequ칤a o exceso de lluvia. La idea del SPI es tener una idea de qu칠 tan probable es tener una cantidad de lluvia igual o menor. Valores altos del SPI est치n asociados con 칠pocas muy h칰medas mientras que valores bajos indican sequ칤a.
En la pr치ctica lo que se hace es la funci칩n de probabilidad acumulada a partir de los registros hist칩ricos y luego estimar la probabilidad para la cantidad observada en cada mes.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no se encontraron art칤culos"
         data-message-one="1 art칤culo encontrado"
         data-message-other="{n} art칤culos encontrados">
         10 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('https://eliocamp.github.io/codigo-r/images/cover2.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/r.min.js" integrity="sha256-XrZQp+ZMfovqr6Hb2M6okHvSEYaB/+Xbx7toWmOOZUM=" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css" integrity="sha256-KacbO6Nou2geGJEUzQeKzKEdp/DENVGJKAd2v37moh0=" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="../../../js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = 'https:\/\/eliocamp.github.io\/codigo-r\/2018\/06\/tu-propio-geom-smooth\/';
          
            this.page.identifier = '\/2018\/06\/tu-propio-geom-smooth\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'codigo-r';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



    
  </body>
</html>

